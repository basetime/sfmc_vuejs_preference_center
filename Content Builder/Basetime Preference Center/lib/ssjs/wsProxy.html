<script runat="server">
  Platform.Load("core", "1.1");

  function wsProxy() {
    var prox = new Script.Util.WSProxy();
    var fn = {};

    /*******************************
     * @config {Object}
     * @return {Object}
     ******************************/
    fn.update = function (config) {
      var obj = config.soapObjName ? config.soapObjName : null;
      var payload = config.payload ? config.payload : null;
      var options = config.options ? config.options : null;
      var mid = config.mid ? config.mid : null;
      // prox = mid ? utils.proxyContext(prox, mid) : prox;

      if (!config) { return 'configuration required'; }
      if (!obj) { return 'SOAP object is required'; }
      if (!payload) { return 'payload is required'; }

      // var batch = utils.isArray(payload);
      var batch = false;

      if (batch) {
        var res = prox.updateBatch(obj, payload, options);
      } else {
        var res = prox.updateItem(obj, payload, options);
      }

      return res;
    } // end update


    return fn
  }

</script>